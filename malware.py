import hashlib

def detectar_malware(archivo):
    """
    Detecta si un archivo contiene malware mediante la comparaci√≥n de su huella digital.
    """
    # Crea un objeto hash
    sha256 = hashlib.sha256()
    try:
        # Abre el archivo en modo binario
        with open(archivo, 'rb') as f:
            # Lee el contenido del archivo en bloques
            for bloque in iter(lambda: f.read(4096), b''):
                sha256.update(bloque)
            # Obtiene la huella digital del archivo
            huella_digital = sha256.hexdigest()
            # Compara la huella digital del archivo con una lista de huellas digitales de malware conocidas
            with open('malware_hashes.txt', 'r') as f:
                for line in f:
                    if huella_digital in line:
                        print(f"Malware detectado en el archivo {archivo}")
                        return
            print(f"El archivo {archivo} no es malware conocido.")
    except (FileNotFoundError, PermissionError):
        print("Error al abrir el archivo.")

archivo = "example.exe"
detectar_malware(archivo)
